export const title = "A developer's first attempt to make something";
export const date = "8 Aug 2023";
export const peek = "";
export const published = false;

# {title}


### Intro
Fresh out of college, I had an idea, I had a plan. It was going to be super successful and make a lot of money.

Well, it didn't exactly turn out the way I hoped. It wasn't too successful at all really. I lost quite a bit of money and had a single frequent user. 

But if I look back and compare my two selfs, one before starting the project and the other after, it's like comparing two different people.

One battled to grasp React and struggled to get it to work nicely in the environment I wanted, 
and the other didn't even break half a sweat setting up [tRPC](https://trpc.io/) in a react and express [Turporepo](https://turbo.build/repo) by pulling in knowledge straight from reading the relevant documentation. 

An eye roll for some, but I felt accomplished, especially since I didn't have experience with any of tools I used up to then, except for express.
It felt good to be able to see where I am and where I was.

Even if the project did not meet my expectations financially, it made me a better developer by significant leaps and bounds. 

This is the story of a developer's first attempt to make something.

### Backstory
The auction house my friend (now girlfriend..) works at got the contract to auction off the whole interior of a beautiful grand hotel that was closing down. 
The action house did not have enough people available for the first week of the job so I volunteered to assist.

The auction had already passed and our job was to label and get each item to their respective buyer.
This was no easy task as the items in the hotel varied greatly in size and shape, from chinese porcelain, to intricate paintings, huge rugs, pottery, long tables and tall statues.
Grand hotel is no overstatement, it was magnificent.

My job was to label everything, my girlfriend managed the logistics of getting the items to the buyers via a six axel truck.
She first had to group buyers by relative area (by searching for each address on google maps).
Then look up the combined volume of what each buyer bought.
Based on that she had to order the buyers on the list to optimize for time.
And finally load the items on the truck in a specific sequence: ie the first stop's items will be loaded last ( to be delivered first) 
and the last last stop's items will be loaded first (to be delivered last).

She did all of this by hand using pen and paper and each route took about an hour to plan.

This problem sparked my interest and I decided to see if I can automate some of the steps.

I deconstructed the job into the following problems:  

Addresses:  
1\. Searching for individual addresses takes a long time.  
2\. Keeping track of each address relative to the others are error prone.  
Possible solution: A birds eye view of all the addresses on a map.

Buyer Volume:  
Unless the auction software exposes a DB api not much can be automated here.

Delivery sequence and statistics:  
3\. Fastest delivery order very unlikely if manually guesstimated.  
4\. Estimated duration and return time valuable for planning.  
Solution: Traveling salesman problem -> route finding algorithm.  

Loading order:  
5\. Simply the reverse of the delivery order.

Delivery route consumption:  
6\. What will the route look like? Table form?  
7\. How will the driver known about it? Printed? Digital?  
Possible solution: A trip sheet is currently made in Excel, printed and given to the driver -> a printable table is good enough.

With these requirements in mind, I set out to solve the problem.

### Early Development
Early development was rough. 
I only had experience with c++ and Angular at this time, 
and I figured c++ wasn't the right tool for the job so I chose the Angular approach.

A basic proof of concept prototype was next. 
It had to: 
Accept a list of addresses, show them on the map and reorder them according to the fastest route.

For the map I decided to use Google Maps due to their generous free credit each month (after which it gets expensive quick). 
Furthermore, I believe they have the best data on South African roads and addresses. 

The first big problem was finding the fastest single route, not wanting to write a complex algorithm myself I researched and found out
that the Google Maps API has a "optimize route" option that can be selected when finding a route with multiple stops.
I don't know how that option solves the traveling salesman problem but I guess they might be using something like [Or Tools](https://developers.google.com/optimization) on the backend.
So that was an easy solution to one of the biggest problems, at least for this simple case.

It did not take too long to get a basic prototype up and running with Angular, and it worked well. Address could be typed into rows and searched for using the Google Geocoder API, 
the address are then displayed on the map and finally a route could be found that rearranges the addresses by fastest route.

The biggest problem though, was actually using the rearranged list of addresses.
Rearrange the addresses in Excel by hand by looking at the app's order? 
Copy and paste to Excel? Or Generate A pdf? But then a whole lot of other information will also need to be given to the app like name and surname, cellphone nr...
It was problematic, I did not forsee this step as the biggest problem.

I looked into any "Excel like" spreadsheet libraries available in javascript, and there were some good ones, but I also stumbled upon the Excel API.

Now this was really interesting. It allows a web app to run right inside of Excel and interact with data on the spreadsheet programmatically!
All Excel requires is a manifest file that pointed to the url your website is hosted on.
This was perfect, especially since people already use Excel for trip sheets and they usually tend to stick to what they already know. 
It won't be a totally new and unfamiliar app to users,
it will merely be an extension to a tool they are already familiar with.

But then a new problem emerged. A problem caused by something all programmers dread and fear. 
The mere thought of it causes a cold sweat followed by an uncontrollable twitch.
It's name inflicts pain on any programmer who dares utter it, and to anyone unfortunate enough to be in the presence of its utterance.
A great darkness, undefeated until recently... It goes by the name of... of Internet Explorer 11.


### Making it work

This was about 2 years ago at the time of writing and Internet Explorer has not been killed of entirely yet. Guess where it was still used?
The environment in which Excel addons are supposed to run in...
This caused a series of headaches, one being that I had just written the proof of concept in Angular 12, and second, lots of libraries don't support IE11 anymore.
Like for instance Angular Material.

I spend a few days trying to get Angular to work in the IE11 environment to no avail.
I was really really sick of struggling, so much so that I decided to let my beloved Angular go in search of greener pastures.

The other two frameworks the Excel Addon Docs had tutorials for was React (of course) and Vue (of course).
I didn't know a lot about Vue at all so I decided to try React. 
This was an odd choice because the last time I tried React (very briefly) I could not get my head around it and did not like it at all.
This was in my compiler construction course though.. Yes I wrote a simple compiler in JS, with BASIC as the target language. It was a lot of fun.

Anyway, after a lot of trial and error, and meticulously picking apart the Excel React starter template I could make a new up to date React 17 Excel add in from scratch.
It is worth mentioning that this was still in IE11, and I needed some hackery to keep everything together, for instance, not one of their templates supported routing. 
this is because, for some reason the Excel API library deletes some function in the global object that is required for routing. 
It had to be cached before loading the library and restored after. Then routing worked perfectly. Thanks Stack Overflow.

Skip ahead a few months of development and I had learned a lot. I tried many things that failed as I did not know better, but I leaned every step of the way.
And I think I became rather good at React, and dare I say, I started to like it. I started to like it a lot. Maybe even more than Angular. Gasp!

### Warming up to React
I was some mixture of laughter, disbelieve and disgust when I searched "React routing" the first time and learned that react does not have built in Routing.
How could it not have built in routing? You have to download a third party library?

It was like this for everything in React. 
In contrast to angular, it includes everything, even the kitchen sink by default or as a first party library. 
If you wanted to use the kitchen sink in React you'd have to go and download the third party KitchenSink.js library.

But later on as I got more experienced and comfortable with React I realized, that feeling I had had vanished.
I realized that it is actually extremely beneficial that React only focuses on doing a small set of thing right and letting the community 
write libraries that add the rest to their hearts content.
The result of this is unbound freedom, and freedom leads to innovation. 
Want to do routing in react? There are 500+ different libraries, all with different ways of doing things. 
Sometimes two libraries may have the same goal but approach the problem with two totally different mental paradigms.
Just look at the smorgasbord of different state management libraries there are, or meta frameworks.

They are all fantastic and and amazing in their own right, and I find that extremely exciting. 
React is innovating and evolving at light speed and thats a good thing, and if it's not it evolving it's some other framework that was inspired by it

### The App
I will now show you how the app works and what it can do, I'll use a real use case and explain different bits and peaces as I go.
Also, I never completely finished the app, its sitting ata around 90% done, 
It is missing a payment system (I did that in the next version) and there are some other small things I still had to to.

But none the less, I learned a lot and I am proud of what I have accomplished, especially since this is my first real attempt at building something.

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/add_in.PNG)](https://remblog.s3.af-south-1.amazonaws.com/add_in.PNG)
Whats this?:

How does it work?:

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/addresses_confirmed.PNG)](https://remblog.s3.af-south-1.amazonaws.com/addresses_confirmed.PNG)

[![Addresses dropdown](https://remblog.s3.af-south-1.amazonaws.com/addresses_dropdown.PNG)](https://remblog.s3.af-south-1.amazonaws.com/addresses_dropdown.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/addresses_on_map.PNG)](https://remblog.s3.af-south-1.amazonaws.com/addresses_on_map.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/addresses_on_map.PNG)](https://remblog.s3.af-south-1.amazonaws.com/addresses_on_map.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/cost.PNG)](https://remblog.s3.af-south-1.amazonaws.com/cost.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/create_vehicle.PNG)](https://remblog.s3.af-south-1.amazonaws.com/create_vehicle.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/create_workspace.PNG)](https://remblog.s3.af-south-1.amazonaws.com/create_workspace.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/load_selected.PNG)](https://remblog.s3.af-south-1.amazonaws.com/load_selected.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/my_workspaces.PNG)](https://remblog.s3.af-south-1.amazonaws.com/my_workspaces.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/route_found.PNG)](https://remblog.s3.af-south-1.amazonaws.com/route_found.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/route_on_map.PNG)](https://remblog.s3.af-south-1.amazonaws.com/route_on_map.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/search_on_map.PNG)](https://remblog.s3.af-south-1.amazonaws.com/search_on_map.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/select_workspace.PNG)](https://remblog.s3.af-south-1.amazonaws.com/select_workspace.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/time_distance.PNG)](https://remblog.s3.af-south-1.amazonaws.com/time_distance.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/trip_builder_1.PNG)](https://remblog.s3.af-south-1.amazonaws.com/trip_builder_1.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/trip_builder_2.PNG)](https://remblog.s3.af-south-1.amazonaws.com/trip_builder_2.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/trip.PNG)](https://remblog.s3.af-south-1.amazonaws.com/trip.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/vehicle_list.PNG)](https://remblog.s3.af-south-1.amazonaws.com/vehicle_list.PNG)

[![The add in](https://remblog.s3.af-south-1.amazonaws.com/vehicle.PNG)](https://remblog.s3.af-south-1.amazonaws.com/vehicle.PNG)




### Outreach

### What I learned and used

### Moving On

### Takeaway
